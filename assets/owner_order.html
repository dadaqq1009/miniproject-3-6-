<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ïú°Í∞úÏû• ÏÑ∏ÌÉÅÎ¨º Ïã†Ï≤≠</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

        <script src="./jquery-3.4.1.min.js"></script>
	<link rel="stylesheet" href="./bootstrapt/css/bootstrap.min.css" />
	<script src="./bootstrapt/js/bootstrap.min.js"></script>
    
</head>
<style>
html,body{width:100%; height:100%;}
.form-control{height:40px; width:300px;}
.flex_center{display:flex; align-items:center; justify-content:center; width:100%; height:100%;}
nav{display:block; float:left;}
.image-table{padding-left:10px;}
#button-req{padding-top:10px;}
.modal {
        position: absolute;
        top: 0;
        left: 0;

        width: 100%;
        height: 100%;

        display: none;

        background-color: rgba(0, 0, 0, 0.4);
}

.modal.show {
        display: block;
}

.modal_body {
        position: absolute;
        top: 50%;
        left: 50%;

        width: 800px;
        height: 600px;

        /* padding: 40px; */

        /* text-align: center; */

        background-color: rgb(255, 255, 255);
        border-radius: 10px;
        box-shadow: 0 2px 3px 0 rgba(34, 36, 38, 0.15);

        transform: translateX(-50%) translateY(-50%);
}
.m_head{
        height: 10%;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        background-color:#e7e5e5;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
}
.m_body{
        height: 100%;
        padding: 20px;
        margin-left : 50px;
}
.m_footer{
        height: 10%;
        padding: 15px;
        background-color:#e7e5e5;
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
        display: flex;
        justify-content: end;
}
.modal_title{
        font-size: 18px;
        color: gray;
        font-weight: 500;
}
.close_btn{
        font-size: 20px;
        color: rgb(139, 139, 139);
        font-weight: 900;
        cursor: pointer;
}
      .modal_label{
        padding-top: 10px;
}
.input_box{
        width: 100%;
        border: 1px solid rgb(189, 189, 189);
        height: 30px;
}
.modal_btn{
        width: 80px;
        height: 30px;
        border-radius: 5px;
        text-align: center;
        font-size: 14px;
        font-weight: bolder;
        padding-top: 5px;
        margin-left: 5px;
        font-family: sans-serif;
}
.cancle{
        background-color: white;
        color: black;
}
.save{
        background-color: rgb(50, 77, 158);
        color: white;
}
.test{
    width: 1200px;
    margin : 20px auto 0px auto;
}
.input-table1 {
  margin-top : 50px;
}
.accordion-item{
  width: 300px;
}
*{margin:0; padding:0;}
html,body{width:100%; height:100%;}
.form-control{height:40px; width:300px;}
body{background-image:url("https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbdByfl%2FbtrVf7i5Uq5%2FjJ5afu7vrUKkgNGmzP2kAk%2Fimg.jpg"); background-repeat:no-repeat; background-size:cover;}
#preview{display:block; width:300px; height:300px; border-raidus:10px; margin-top: 30px;}
.flex_center{display:flex; align-items:center; justify-content:center; width:100%; height:100%;}
nav{display:block; float:left;}
.image-table{padding-left:50px; margin-top: 40px;}
#button-req{padding-top:10px;}

</style>
<body>
    <div id="order-box" class="test">
        
    </div>
   
    <script
    src="https://code.jquery.com/jquery-3.5.1.js"
    integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
    integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
    crossorigin="anonymous"
  ></script>
  <script>
    // click on ÎùºÎ≤® Ï∂îÍ∞Ä Î™®Îã¨ Ïó¥Í∏∞
$(document).on('click', '#add-btn', function (e) {
  console.log("click event");
  $(e.target).next('.modal').addClass('show')
});

// Î™®Îã¨ Îã´Í∏∞
$(document).on('click', '#close_btn', function (e) {
  console.log("click event");
  $(e.target).parents('.modal').removeClass('show')

});
</script>
<script>
    const url = window.location.search;
    console.log(url)
    const url_split = url.split('=')
    const login_id = url_split[1]
    console.log(login_id);
    show_order(login_id);
    function show_order(){
        $.ajax({
            type: "GET",
            url: `/api/order/owner?login_id=${login_id}`,
            data: {},
            success: function (response) {
               
                let rows = response['cloth']
                let name_rows = response['guests']
                console.log(rows)
                let temp_html = ''
                  for (let i =0; i < rows.length; i++){
                    let tel = rows[i]['tel']
                    let address = rows[i]['address']
                    let ask = rows[i]['ask']
                    let name = name_rows[i]
                    let clothId = rows[i]['cloth_id']
                    
                    temp_html += `
                    <div>${name}</div>
                    <div class="btn" id="add-btn"><img src='/img/Îã§Ïö¥Î°úÎìú.jpg'>
                    <div class="modal" id="modal">
                      <div class="modal_body">
                        <div class="m_head">
                          <div class="modal_title">üß∫ÏÑ∏ÌÉÅÎ¨º ÏàòÍ±∞ÌéòÏù¥ÏßÄüß∫</div>
                          <div class="close_btn" id="close_btn">X</div>
                        </div>
                        <nav class="input-table1">
                              <div class="mb-3" id="nickName" >
                                <!-- <label for="exampleInputEmail1" class="form-label">ÎãâÎÑ§ÏûÑ</label> -->
                                <!-- <input type="email" class="form-control" id="exampleInputEmail1" placeholder="ÎãâÎÑ§ÏûÑ" aria-describedby="emailHelp"> -->
                              </div>
                              <div class="accordion" id="accordionExample">
                                <div class="accordion-item">
                                  <h2 class="accordion-header">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                      Ï†ÑÌôîÎ≤àÌò∏
                                    </button>
                                  </h2>
                                  <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                                    <div class="accordion-body">
                                      ${tel}
                                    </div>
                                  </div>
                                </div>
                              </div>
                            
                              <div class="accordion" id="accordionExample">
                                <div class="accordion-item">
                                  <h2 class="accordion-header">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                      Ï£ºÏÜå
                                    </button>
                                  </h2>
                                  <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                                    <div class="accordion-body">
                                      ${address}
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="accordion" id="accordionExample">
                                <div class="accordion-item">
                                  <h2 class="accordion-header" >
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                      ÏöîÏ≤≠ÏÇ¨Ìï≠
                                    </button>
                                  </h2>
                                  <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                                    <div class="accordion-body">
                                      ${ask}
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </nav>
                            <nav class="image-table">
                              <img id="preview" src="https://web.ipca.pt/sap/wp-content/codevision/resources/images/no-image.jpg">
                              <input type="file" id="inputFile" onchange="readURL(this);" style="display:none;">
                              <div id="button-req">
                                <button type="button" class="btn btn-dark" style="width:300px"  onclick="save_order(${clothId})">Ïã†Ï≤≠ÌïòÍ∏∞</button>
                              </div>
                            </nav>
                      </div>
                  </div>
`         
                }
                
                $('#order-box').append(temp_html)
            }
        });
    }

    function save_order(clothId) {

      console.log(clothId)

        $.ajax({
          type: "PUT",
          url: `/api/order/owner?login_id=${login_id}`,
          data: {
            cloth_id : clothId
          },
          success: function (response) {
            alert(JSON.stringify(response))
              window.location.replace(`/mypage/owner?login_id=${login_id}`);

          },
          error: function (error) {
            customAlert(error.responseJSON.errorMessage);
          },
        });
      };
    function customAlert(text, confirmCallback) {
    $("#alertText").text(text);
    $("#alertModal").modal("show");
    if (confirmCallback) {
      $("#alertModal .btn-confirm").click(confirmCallback);
    }
  }
</script>
</body>
</html>